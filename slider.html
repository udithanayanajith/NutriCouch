<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Medical Results Prediction</title>
    <link rel="stylesheet" type="text/css" href="./css/slider.css" />
    <link rel="stylesheet" href="./css/footer.css" />
  </head>
  <body>
    <div>
      <a href="index.html" class="button-1"> Back</a>
    </div>

    <div class="Predcontainer">
      <span class="title">Medical Results Prediction</span>
      <!-- <h1></h1> -->

      <form id="predictionForm">
        <label for="ageCategory">Age Category:</label>
        <select id="ageCategory">
          <option value="1">0 to 1 year</option>
          <option value="2">1+ to 2 year</option>
          <option value="3">2+ to 5 year</option>
        </select>

        <label for="weight">Weight (in kg):</label>
        <input type="text" id="weight" required />

        <label for="height">Height (in cm):</label>
        <input type="range" id="height" min="0" max="200" step="1" />
        <div id="heightValue">0 cm</div>

        <button type="submit">Predict</button>
      </form>

      <div id="result"></div>
    </div>
    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <h6>About</h6>
            <p class="text-justify">
              Today, with the economic crisis in the country, the nutritional
              level of many people is decreasing. Children are the most
              affected. Here we identify the nutritional level of children under
              5 years of age and give the necessary health advice to the child
              according to that level and suggest suitable foods according to
              their nutritional level and give the necessary advice to relieve
              them from it.
            </p>
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Categories</h6>
            <ul class="footer-links">
              <li>
                <a href="./chatbot.html">Nutri Choch ChatBot</a>
              </li>
              <li>
                <a href="./moh.html">MOH Contacts</a>
              </li>
              <li>
                <a href="./slider.html">Future Predictions</a>
              </li>
            </ul>
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Quick Links</h6>
            <ul class="footer-links">
              <li class="scroll active"><a href="./index.html">Home</a></li>
              <li class="scroll">
                <a href="./features/feature.html">Fetures</a>
              </li>
              <li class="scroll"><a href="./about/about.html">About</a></li>
              <li class="scroll"><a href="./levels/level.html">Levels</a></li>
              <li class="scroll">
                <a href="./gallery/gallery.html">Gallery</a>
              </li>
              <li class="scroll">
                <a href="./testimonial/testimonial.html">Testimonial</a>
              </li>
              <li class="scroll"><a href="./moh.html">Moh Offices</a></li>
              <li class="scroll"><a href="./slider.html">Slider</a></li>
            </ul>
          </div>
        </div>
        <hr />
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">
              Copyright &copy; 2023 All Rights Reserved by
              <a href="#">Nutri Choch</a>.
            </p>
          </div>

          <div class="col-md-4 col-sm-6 col-xs-12"></div>
        </div>
      </div>
    </footer>
    <script>
      const heightSlider = document.getElementById("height");
      const heightValue = document.getElementById("heightValue");

      heightSlider.addEventListener("input", function () {
        const sliderValue = heightSlider.value;
        heightValue.textContent = sliderValue + " cm";

        heightSlider.style.setProperty("--value", `"${sliderValue}"`);
      });
    </script>
    <script>
      const weightInput = document.getElementById("weight");

      weightInput.addEventListener("input", function () {
        const value = weightInput.value;
        if (!isValidNumber(value)) {
          weightInput.setCustomValidity("Please enter a valid weight.");
        } else {
          weightInput.setCustomValidity("");
        }
      });

      function isValidNumber(value) {
        // Check if the value is a valid number (allowing floating-point numbers)
        return !isNaN(parseFloat(value)) && isFinite(value);
      }
    </script>
    <script>
      document
        .getElementById("predictionForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          var ageCategory = document.getElementById("ageCategory").value;
          var weight = document.getElementById("weight").value;
          var height = document.getElementById("height").value;

          if (ageCategory === "" || weight === "" || height === "") {
            alert("Please fill in all fields.");
            return;
          }

          fetch("http://127.0.0.1:5000/predict", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              age: ageCategory,
              weight: weight,
              height: height,
            }),
          })
            .then(function (response) {
              return response.json();
            })
            .then(function (data) {
              var resultText = "";

              // Check the 'stage' property in the response
              switch (data.stage) {
                case 1:
                  resultText = "Normal baby";
                  document.body.style.backgroundColor = "#0bd641";
                  break;
                case 2:
                  resultText = "Moderate";
                  document.body.style.backgroundColor = "orange";
                  break;
                case 3:
                  resultText = "Severe";
                  document.body.style.backgroundColor = "red";
                  break;
                case 4:
                  resultText = "Mild";
                  document.body.style.backgroundColor = "#acfaac";
                  break;
                default:
                  resultText = "Unknown stage";
                  document.body.style.backgroundColor = "black";
              }

              document.getElementById("result").textContent = resultText;
            })
            .catch(function (error) {
              console.error("Error:", error);
            });
        });
    </script>
  </body>
</html>
